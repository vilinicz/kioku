(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{172:function(e,t,n){var content=n(184);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(53).default)("066b6f0e",content,!0,{sourceMap:!1})},173:function(e,t,n){var content=n(186);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(53).default)("0ace817b",content,!0,{sourceMap:!1})},174:function(e,t,n){"use strict";var r=n(6),o=n(175)(5),c=!0;"find"in[]&&Array(1).find((function(){c=!1})),r(r.P+r.F*c,"Array",{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(72)("find")},175:function(e,t,n){var r=n(26),o=n(71),c=n(27),d=n(21),l=n(176);e.exports=function(e,t){var n=1==e,f=2==e,m=3==e,v=4==e,h=6==e,x=5==e||h,w=t||l;return function(t,l,y){for(var N,k,I=c(t),E=o(I),_=r(l,y,3),C=d(E.length),A=0,F=n?w(t,C):f?w(t,0):void 0;C>A;A++)if((x||A in E)&&(k=_(N=E[A],A,I),e))if(n)F[A]=k;else if(k)switch(e){case 3:return!0;case 5:return N;case 6:return A;case 2:F.push(N)}else if(v)return!1;return h?-1:m||v?v:F}}},176:function(e,t,n){var r=n(177);e.exports=function(e,t){return new(r(e))(t)}},177:function(e,t,n){var r=n(10),o=n(106),c=n(2)("species");e.exports=function(e){var t;return o(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!o(t.prototype)||(t=void 0),r(t)&&null===(t=t[c])&&(t=void 0)),void 0===t?Array:t}},178:function(e,t,n){"use strict";var r=n(3),o=n(15),c=n(20),d=n(107),l=n(54),f=n(9),m=n(37).f,v=n(55).f,h=n(8).f,x=n(179).trim,w=r.Number,y=w,N=w.prototype,k="Number"==c(n(70)(N)),I="trim"in String.prototype,E=function(e){var t=l(e,!1);if("string"==typeof t&&t.length>2){var n,r,o,c=(t=I?t.trim():x(t,3)).charCodeAt(0);if(43===c||45===c){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===c){switch(t.charCodeAt(1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+t}for(var code,d=t.slice(2),i=0,f=d.length;i<f;i++)if((code=d.charCodeAt(i))<48||code>o)return NaN;return parseInt(d,r)}}return+t};if(!w(" 0o1")||!w("0b1")||w("+0x1")){w=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof w&&(k?f((function(){N.valueOf.call(n)})):"Number"!=c(n))?d(new y(E(t)),n,w):E(t)};for(var _,C=n(7)?m(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),A=0;C.length>A;A++)o(y,_=C[A])&&!o(w,_)&&h(w,_,v(y,_));w.prototype=N,N.constructor=w,n(11)(r,"Number",w)}},179:function(e,t,n){var r=n(6),o=n(19),c=n(9),d=n(180),l="["+d+"]",f=RegExp("^"+l+l+"*"),m=RegExp(l+l+"*$"),v=function(e,t,n){var o={},l=c((function(){return!!d[e]()||"​"!="​"[e]()})),f=o[e]=l?t(h):d[e];n&&(o[n]=f),r(r.P+r.F*l,"String",o)},h=v.trim=function(e,t){return e=String(o(e)),1&t&&(e=e.replace(f,"")),2&t&&(e=e.replace(m,"")),e};e.exports=v},180:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},181:function(e,t,n){const r=n(182);function o(e,t){t.value!==t.oldValue&&(e.oninput=o.debounce((function(t){e.dispatchEvent(function(e){if("function"==typeof Event)var t=new Event(e);else{(t=document.createEvent("Event")).initEvent(e,!0,!0)}return t}("change"))}),parseInt(t.value)||800))}o.debounce=r,e.exports=o},182:function(e,t){e.exports=function(e,t){var n=null;return function(){clearTimeout(n);var r=arguments,o=this;n=setTimeout((function(){e.apply(o,r)}),t)}}},183:function(e,t,n){"use strict";var r=n(172);n.n(r).a},184:function(e,t,n){(e.exports=n(52)(!1)).push([e.i,".face-card[data-v-12a1a1c2]{padding:1rem;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-flow:column;-webkit-box-pack:center;justify-content:center;-webkit-transition:all .4s ease,background-color 1.5s ease-in-out;transition:all .4s ease,background-color 1.5s ease-in-out}.face-card[data-v-12a1a1c2]:not(:last-child){border-bottom:1px solid #ebeef5}.face-card .wrapper[data-v-12a1a1c2]{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row nowrap}.face-card .image[data-v-12a1a1c2]{position:relative;border-radius:16px;width:28vw;height:28vw;max-width:230px;max-height:230px;min-width:100px;min-height:100px;margin-right:1rem;background-color:#f2f6fc;background-repeat:no-repeat;background-size:cover;background-position:50%;flex-shrink:0;box-shadow:inset 0 0 10px rgba(0,0,0,.2)}.face-card .image .status[data-v-12a1a1c2]{position:absolute;top:-8px;right:-8px;width:26px;height:26px;box-shadow:0 0 0 4px #fff;border-radius:13px;background-color:#dcdfe6}.face-card .image .status.on[data-v-12a1a1c2]{background-color:#67c23a}@media (min-width:768px){.face-card .image[data-v-12a1a1c2]{margin-right:2rem}}.face-card .wrap[data-v-12a1a1c2]{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row nowrap}.face-card .wrap .input-name[data-v-12a1a1c2]{margin-right:1rem;flex-basis:75%}.face-card .wrap .input-room[data-v-12a1a1c2]{flex-basis:25%;text-align:right;font-weight:500}.face-card .input[data-v-12a1a1c2]{font-size:1.4rem;width:100%;color:#2c3e50;background-color:#f2f6fc;margin-bottom:1rem;padding:.25rem .5rem;border-radius:8px}@media (min-width:768px){.face-card .input[data-v-12a1a1c2]{font-size:2.2rem;padding:.25rem 1rem}}.face-card .input-note[data-v-12a1a1c2]{font-size:1.2rem;resize:none;margin-bottom:0;display:block}@media (min-width:768px){.face-card .input-note[data-v-12a1a1c2]{font-size:1.75rem}}@media (min-width:768px){.face-card[data-v-12a1a1c2]{padding:2rem}}",""])},185:function(e,t,n){"use strict";var r=n(173);n.n(r).a},186:function(e,t,n){(e.exports=n(52)(!1)).push([e.i,"#app{line-height:1.6;min-height:100vh;font-family:Avenir Next,sans-serif}#app,#app input{color:#303133}.error{background-color:rgba(245,108,108,.8);color:#fff;font-weight:700;position:absolute;top:0;left:0;width:100%;text-align:center;padding:.75rem;z-index:99}.cards-enter{opacity:0;-webkit-transform:translateY(-30vh);transform:translateY(-30vh);background-color:#fefbec}.cards-enter-to{opacity:1;-webkit-transform:none;transform:none;background-color:#fff}.cards-leave-to{opacity:0}.cards-leave-active{position:absolute}",""])},188:function(e,t,n){"use strict";n.r(t);n(174),n(18),n(56),n(178);var r=n(181),o={name:"FaceCard",directives:{debounce:n.n(r).a},props:{id:{type:Number,default:0},name:{type:String,default:""},room:{type:Number,default:void 0},note:{type:String,default:""},image:{type:String,default:""},datetime:{type:Number,default:0}},data:function(){return{editableName:this.name,editableRoom:this.room,editableNote:this.note,refreshing:null,online:!0,delay:400}},watch:{editableName:function(){this.update()},editableRoom:function(){this.update()},editableNote:function(){this.update()}},beforeDestroy:function(){clearInterval(this.refreshing)},created:function(){this.refresh()},methods:{update:function(){var e;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("update"),e={name:this.editableName,room:this.editableRoom,note:this.editableNote},t.next=4,regeneratorRuntime.awrap(this.$axios.patch("faces/".concat(this.id),e));case 4:case"end":return t.stop()}}),null,this)},refresh:function(){var e=this;this.refreshing=setInterval((function(){e.online=(Date.now()-e.datetime)/1e3<3,(Date.now()-e.datetime)/1e3>180&&e.$emit("destroy",e.id)}),1e3)}}},c=(n(183),n(47)),d={components:{FaceCard:Object(c.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"face-card"},[n("div",{staticClass:"wrapper"},[n("div",{staticClass:"image",style:{backgroundImage:"url(data:image/jpeg;base64,"+e.image+")"}},[n("div",{staticClass:"status",class:{on:e.online}})]),e._v(" "),n("form",{staticClass:"summary",attrs:{action:"#"}},[n("div",{staticClass:"wrap"},[n("input",{directives:[{name:"model",rawName:"v-model.lazy",value:e.editableName,expression:"editableName",modifiers:{lazy:!0}},{name:"debounce",rawName:"v-debounce",value:e.delay,expression:"delay"}],staticClass:"input input-name",attrs:{placeholder:"Имя",type:"text"},domProps:{value:e.editableName},on:{change:function(t){e.editableName=t.target.value}}}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.lazy",value:e.editableRoom,expression:"editableRoom",modifiers:{lazy:!0}},{name:"debounce",rawName:"v-debounce",value:e.delay,expression:"delay"}],staticClass:"input input-room",attrs:{placeholder:"#",type:"number",min:"0",inputmode:"numeric",pattern:"[0-9]*"},domProps:{value:e.editableRoom},on:{change:function(t){e.editableRoom=t.target.value}}})]),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model.lazy",value:e.editableNote,expression:"editableNote",modifiers:{lazy:!0}},{name:"debounce",rawName:"v-debounce",value:e.delay,expression:"delay"}],staticClass:"input input-note",attrs:{rows:"4",placeholder:"Дополнительно",type:"text"},domProps:{value:e.editableNote},on:{change:function(t){e.editableNote=t.target.value}}})])])])}),[],!1,null,"12a1a1c2",null).exports},data:function(){return{polling:null,sorting:null,faces:[],error:void 0}},beforeDestroy:function(){clearInterval(this.polling),clearInterval(this.sorting)},created:function(){this.pollData(),this.sortFaces()},methods:{removeOldFace:function(e){this.faces=this.faces.filter((function(t){return t.id!==e}))},sortFaces:function(){var e=this;this.polling=setInterval((function(){e.faces=e.faces.sort((function(a,b){return b.datetime-a.datetime}))}),2e3)},pollData:function(){var e=this;this.polling=setInterval((function(){e.get()}),1e3)},get:function(){var e,t,n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e={},r.prev=1,r.next=4,regeneratorRuntime.awrap(this.$axios.get("/current_face/1"));case 4:t=r.sent,e=t.data,this.error=void 0,r.next=12;break;case 9:r.prev=9,r.t0=r.catch(1),this.error=r.t0;case 12:e.id&&(e.datetime=Date.now(),(n=this.faces.find((function(t){return t.id===e.id})))?((Date.now()-n.datetime)/1e3>3&&(n.image=e.image),n.datetime=Date.now()):(8===this.faces.length&&this.faces.pop(),this.faces.unshift(e)));case 13:case"end":return r.stop()}}),null,this,[[1,9]])}}},l=(n(185),Object(c.a)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e.error?n("div",{staticClass:"error"},[e._v("\n    "+e._s(e.error)+"\n  ")]):e._e(),e._v(" "),n("transition-group",{attrs:{name:"cards",tag:"div"}},e._l(e.faces,(function(t){return n("FaceCard",e._b({key:t.id,on:{destroy:e.removeOldFace}},"FaceCard",t,!1))})),1)],1)}),[],!1,null,null,null));t.default=l.exports}}]);